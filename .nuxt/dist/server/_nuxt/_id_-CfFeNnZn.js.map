{"version":3,"file":"_id_-CfFeNnZn.js","sources":["../../../../pages/edit-listing/[id].vue"],"sourcesContent":["<template>\r\n  <!-- Breadcrumb Area -->\r\n  <section class=\"breadcrumb-area bread-bg\">\r\n    <div class=\"overlay\"></div>\r\n    <div class=\"container\">\r\n      <div class=\"breadcrumb-content text-center\">\r\n        <h2 class=\"sec__title text-white mb-3\">Edit Listing</h2>\r\n        <ul class=\"bread-list\">\r\n          <li><a href=\"/\">Home</a></li>\r\n          <li>Listing</li>\r\n          <li>Edit Listing</li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n    <div class=\"bread-svg\">\r\n      <svg viewBox=\"0 0 500 150\" preserveAspectRatio=\"none\">\r\n        <path d=\"M-4.22,89.30 C280.19,26.14 324.21,125.81 511.00,41.94 L500.00,150.00 L0.00,150.00 Z\"></path>\r\n      </svg>\r\n    </div>\r\n  </section>\r\n\r\n  <!-- Edit Listing Form -->\r\n  <section class=\"add-listing-area padding-top-60px padding-bottom-90px\">\r\n    <div class=\"container\">\r\n      <!-- Alert for Returning Users -->\r\n      <div class=\"alert alert-info fade show mb-4\" role=\"alert\">\r\n        <p><strong class=\"font-weight-semi-bold\">Returning User? Please</strong> <a href=\"/login\" class=\"alert-link font-weight-semi-bold\">log in</a> and if you are a New User, Continue Below and register along with this submission.</p>\r\n      </div>\r\n\r\n      <!-- Edit Listing Form -->\r\n      <form @submit.prevent=\"updateEvent\">\r\n        <div class=\"card\">\r\n          <div class=\"card-body\">\r\n            <h4 class=\"card-title mb-3\">Basic Information</h4>\r\n            <hr class=\"border-top-gray my-0\" />\r\n\r\n            <!-- Form Inputs -->\r\n            <div class=\"row mt-4\">\r\n              <div class=\"col-lg-6\">\r\n                <div class=\"form-group\">\r\n                  <label class=\"label-text\">Title <span class=\"required\">*</span></label>\r\n                  <input class=\"form-control form--control ps-3\" type=\"text\" v-model=\"formData.title\" placeholder=\"Title\" required />\r\n                </div>\r\n              </div>\r\n              <div class=\"col-lg-6\">\r\n                <div class=\"form-group\">\r\n                  <label class=\"label-text\">Event Type <span class=\"required\">*</span></label>\r\n                  <select class=\"form-control form--control ps-3\" v-model=\"formData.event_type\" required>\r\n                    <option value=\"online\">Online</option>\r\n                    <option value=\"physical\">Physical</option>\r\n                    <option value=\"hybrid\">Hybrid</option>\r\n                  </select>\r\n                </div>\r\n              </div>\r\n              <div class=\"col-lg-6\">\r\n                <div class=\"form-group\">\r\n                  <label class=\"label-text\">Country <span class=\"required\">*</span></label>\r\n                  <input class=\"form-control form--control ps-3\" type=\"text\" v-model=\"formData.country\" placeholder=\"Country\" required />\r\n                </div>\r\n              </div>\r\n              <div class=\"col-lg-6\">\r\n                <div class=\"form-group\">\r\n                  <label class=\"label-text\">Venue <span class=\"required\">*</span></label>\r\n                  <input class=\"form-control form--control ps-3\" type=\"text\" v-model=\"formData.venue\" placeholder=\"Venue\" required />\r\n                </div>\r\n              </div>\r\n              <div class=\"col-lg-6\">\r\n                <div class=\"form-group\">\r\n                  <label class=\"label-text\">Event Date <span class=\"required\">*</span></label>\r\n                  <input class=\"form-control form--control ps-3\" type=\"date\" v-model=\"formData.event_date\" required />\r\n                </div>\r\n              </div>\r\n              <div class=\"col-lg-6\">\r\n                <div class=\"form-group\">\r\n                  <label class=\"label-text\">Event Time <span class=\"required\">*</span></label>\r\n                  <input class=\"form-control form--control ps-3\" type=\"time\" v-model=\"formData.event_time\" required />\r\n                </div>\r\n              </div>\r\n              <div class=\"col-lg-12\">\r\n                <div class=\"form-group\">\r\n                  <label class=\"label-text\">Category <span class=\"required\">*</span></label>\r\n                  <input class=\"form-control form--control ps-3\" type=\"text\" v-model=\"formData.category\" required />\r\n                </div>\r\n              </div>\r\n              <div class=\"col-lg-12\">\r\n                <div class=\"form-group\">\r\n                  <label class=\"label-text\">Website Link <span class=\"required\">*</span></label>\r\n                  <input class=\"form-control form--control ps-3\" type=\"url\" v-model=\"formData.website_link\" required />\r\n                </div>\r\n              </div>\r\n              <div class=\"col-lg-12\">\r\n                <div class=\"form-group\">\r\n                  <label class=\"label-text\">Description <span class=\"required\">*</span></label>\r\n                  <Editor :content=\"description\" @update:content=\"description = $event\" />\r\n                </div>\r\n              </div>\r\n              <div class=\"col-lg-12\">\r\n                <div class=\"form-group\">\r\n                  <label class=\"label-text\">Video Link</label>\r\n                  <input class=\"form-control form--control ps-3\" type=\"url\" v-model=\"formData.video_link\" />\r\n                </div>\r\n              </div>\r\n              <div class=\"col-lg-12\">\r\n                <div class=\"form-group\">\r\n                  <label class=\"label-text\">Featured Photo <span class=\"required\">*</span></label>\r\n                  <input class=\"form-control form--control ps-3\" type=\"file\" @change=\"handleFileUpload\" />\r\n                  <img v-if=\"imagePreview\" :src=\"imagePreview\" class=\"img-thumbnail mt-2\" />\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Submit Button -->\r\n        <button class=\"theme-btn border-0 mt-3\" type=\"submit\">Update Listing</button>\r\n      </form>\r\n    </div>\r\n  </section>\r\n</template>\r\n\r\n<script setup>\r\nimport { useRouter, useRoute } from 'vue-router';\r\nimport { ref, defineAsyncComponent, onMounted } from 'vue';\r\nimport eventService from '~/services/eventService'; // Adjust the path based on your project structure\r\n\r\nconst route = useRoute();\r\nconst router = useRouter();\r\nconst Editor = defineAsyncComponent(() => import('~/components/Editor.vue'));\r\n\r\nconst description = ref('');\r\nconst editorKey = ref(0);\r\nconst formData = ref({\r\n  title: '',\r\n  user_id: '', // You need to set this based on your authentication logic\r\n  event_type: '',\r\n  country: '',\r\n  venue: '',\r\n  event_date: '',\r\n  event_time: '',\r\n  category: '',\r\n  website_link: '',\r\n  video_link: '',\r\n  featured_photo: ''\r\n});\r\nconst imagePreview = ref(null);\r\n\r\n// Fetch event data on component mount\r\nonMounted(async () => {\r\n  const eventId = route.params.id; // Assuming 'id' is the dynamic segment in your route\r\n  if (eventId) {\r\n    try {\r\n      const event = await eventService.getEvent(eventId); // Replace with your actual service method\r\n      // Populate form data with fetched event data\r\n      formData.value = {\r\n        title: event.title,\r\n        user_id: event.user_id,\r\n        event_type: event.event_type,\r\n        country: event.country,\r\n        venue: event.venue,\r\n        event_date: event.event_date,\r\n        event_time: event.event_time,\r\n        category: event.category,\r\n        website_link: event.website_link,\r\n        video_link: event.video_link,\r\n        featured_photo: null // You may need to handle file preview separately if needed\r\n      };\r\n      description.value = event.description;\r\n    } catch (error) {\r\n      console.error('Error fetching event:', error);\r\n      // Handle error, e.g., show error message\r\n    }\r\n  }\r\n});\r\n\r\n// Reset form function\r\nconst resetForm = () => {\r\n  formData.value = {\r\n    title: '',\r\n    user_id: '',\r\n    event_type: '',\r\n    country: '',\r\n    venue: '',\r\n    event_date: '',\r\n    event_time: '',\r\n    category: '',\r\n    website_link: '',\r\n    video_link: '',\r\n    featured_photo: ''\r\n  };\r\n  description.value = '';\r\n  editorKey.value += 1;\r\n  imagePreview.value = null;\r\n};\r\n\r\n// Handle file upload function\r\nconst handleFileUpload = (event) => {\r\n  const file = event.target.files[0];\r\n  formData.value.featured_photo = file;\r\n  if (file) {\r\n    const reader = new FileReader();\r\n    reader.onload = (e) => {\r\n      imagePreview.value = e.target.result;\r\n    };\r\n    reader.readAsDataURL(file);\r\n  }\r\n};\r\n\r\n// Update event function\r\nconst updateEvent = async () => {\r\n  try {\r\n    const eventData = new FormData();\r\n    eventData.append('title', formData.value.title);\r\n    // Append other form data fields as needed\r\n    eventData.append('description', description.value);\r\n    eventData.append('featured_photo', formData.value.featured_photo);\r\n\r\n    const eventId = route.params.id; // Assuming 'id' is the dynamic segment in your route\r\n    await eventService.updateEvent(eventId, eventData); // Replace with your actual service method\r\n\r\n    useNuxtApp().$toast.success('Event updated successfully!', {\r\n      autoClose: 5000,\r\n      theme: 'colored',\r\n      dangerouslyHTMLString: true\r\n    });\r\n    resetForm();\r\n  } catch (error) {\r\n    console.error('Error updating event:', error);\r\n    alert('Failed to update event. Please try again.');\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n/* Your scoped styles */\r\n.form-control {\r\n  margin-bottom: 1rem;\r\n}\r\n.img-thumbnail {\r\n  max-width: 30%;\r\n  height: auto;\r\n}\r\n.theme-btn {\r\n  margin-top: 1rem;\r\n}\r\n</style>\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AA6Hc,aAAW;AACV,cAAY;AAC3B,UAAM,SAAS,qBAAqB,MAAM,OAAO,sBAAyB,CAAC;AAE3E,UAAM,cAAc,IAAI,EAAE;AACR,QAAI,CAAC;AACvB,UAAM,WAAW,IAAI;AAAA,MACnB,OAAO;AAAA,MACP,SAAS;AAAA;AAAA,MACT,YAAY;AAAA,MACZ,SAAS;AAAA,MACT,OAAO;AAAA,MACP,YAAY;AAAA,MACZ,YAAY;AAAA,MACZ,UAAU;AAAA,MACV,cAAc;AAAA,MACd,YAAY;AAAA,MACZ,gBAAgB;AAAA,IAClB,CAAC;AACD,UAAM,eAAe,IAAI,IAAI;;;;;;;;;;;;;;;;;;;;;;;;"}
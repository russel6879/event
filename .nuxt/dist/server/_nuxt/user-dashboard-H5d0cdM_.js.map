{"version":3,"file":"user-dashboard-H5d0cdM_.js","sources":["../../../../pages/user-dashboard.vue"],"sourcesContent":["<template>\r\n <section class=\"breadcrumb-area bread-bg py-5\">\r\n      <div class=\"overlay\"></div>\r\n      <!-- end overlay -->\r\n      <div class=\"container\">\r\n        <div class=\"breadcrumb-content text-center\">\r\n        \r\n          <h2 class=\"sec__title text-white mb-3\">Dashboard</h2>\r\n          <h2 class=\"sec__title text-white mb-3\">Dashboard</h2>\r\n          <ul class=\"bread-list\">\r\n            <li><a href=\"index.html\">home</a></li>\r\n            <li>pages</li>\r\n            <li>Dashboard</li>\r\n          </ul>\r\n        </div>\r\n        <!-- end breadcrumb-content -->\r\n      </div>\r\n      <!-- end container -->\r\n    </section>\r\n    <!-- end breadcrumb-area -->\r\n    <!-- ================================\r\n    END BREADCRUMB AREA\r\n================================= -->\r\n\r\n    <!-- ================================\r\n    START DASHBOARD AREA\r\n================================= -->\r\n    <section class=\"dashboard-area padding-bottom-70px\">\r\n      <div class=\"bg-white shadow-sm py-4\">\r\n        <div class=\"container\">\r\n          <div\r\n            class=\"dashboard-nav d-flex flex-wrap align-items-center justify-content-between\"\r\n          >\r\n            <ul\r\n              class=\"nav nav-tabs my-tabs my-tabs-2 justify-content-center my-1\"\r\n              id=\"myTab\"\r\n              role=\"tablist\"\r\n            >\r\n              <li class=\"nav-item\" role=\"presentation\">\r\n                <a\r\n                  class=\"nav-link active\"\r\n                  id=\"listings-tab\"\r\n                  data-bs-toggle=\"tab\"\r\n                  href=\"#listings\"\r\n                  role=\"tab\"\r\n                  aria-controls=\"listings\"\r\n                  aria-selected=\"true\"\r\n                >\r\n                  <i class=\"fal fa-list me-1 font-size-14\"></i> Listings\r\n                </a>\r\n              </li>\r\n              <li class=\"nav-item\" role=\"presentation\">\r\n                <a\r\n                  class=\"nav-link\"\r\n                  id=\"settings-tab\"\r\n                  data-bs-toggle=\"tab\"\r\n                  href=\"#settings\"\r\n                  role=\"tab\"\r\n                  aria-controls=\"settings\"\r\n                  aria-selected=\"false\"\r\n                >\r\n                  <i class=\"fal fa-cog me-1 font-size-14\"></i> Settings\r\n                </a>\r\n              </li>\r\n              <!-- <li class=\"nav-item\" role=\"presentation\">\r\n                <a\r\n                  class=\"nav-link\"\r\n                  id=\"bookmarks-tab\"\r\n                  data-bs-toggle=\"tab\"\r\n                  href=\"#bookmarks\"\r\n                  role=\"tab\"\r\n                  aria-controls=\"bookmarks\"\r\n                  aria-selected=\"false\"\r\n                >\r\n                  <i class=\"fas fa-bookmark me-1 font-size-14\"></i> Bookmarks\r\n                </a>\r\n              </li> -->\r\n            </ul>\r\n            <div class=\"my-1\">\r\n              <NuxtLink to=\"/6add-listing\" \r\n                class=\"theme-btn theme-btn-sm bg-white shadow-sm border border-gray text-black font-weight-medium me-1\"\r\n                ><i class=\"fal fa-plus me-1\"></i> Add listing</NuxtLink>\r\n              <button\r\n               @click=\"logoutUser\"\r\n                class=\"theme-btn theme-btn-sm bg-white shadow-sm border border-gray text-black font-weight-medium\"\r\n                ><i class=\"fal fa-sign-out me-1\"></i> Log out</button >\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <!-- end container -->\r\n      </div>\r\n      <div class=\"container\">\r\n        <div class=\"tab-content mt-4\" id=\"myTabContent\">\r\n          <div\r\n            class=\"tab-pane fade show active\"\r\n            id=\"listings\"\r\n            role=\"tabpanel\"\r\n            aria-labelledby=\"listings-tab\"\r\n          >\r\n            <div class=\"row\">\r\n              <div class=\"col-lg-4 col-md-6\" v-for=\"event in events\" :key=\"event.id\">\r\n                <div class=\"card hover-y\">\r\n                  <a  class=\"card-image\">\r\n                    <img\r\n                      \r\n                     :src=\"`${$config.public.baseURL}/`+event.featured_photo\"\r\n                      class=\"card-img-top lazy\"\r\n                      alt=\"card image\"\r\n                    />\r\n                    <span class=\"badge text-bg-success badge-pill\"\r\n                      >Now open</span\r\n                    >\r\n                  </a>\r\n                  <div class=\"card-body position-relative\">\r\n                    <a href=\"#\" class=\"card-cat mb-2\"\r\n                      ><span\r\n                        class=\"fal fa-utensils icon-element icon-element-sm\"\r\n                      ></span>\r\n                      {{ event.category }}</a\r\n                    >\r\n                    <h4 class=\"card-title mb-1\">\r\n                      <a href=\"listing-details.html\"\r\n                        >{{ event.title }}</a\r\n                      >\r\n                    </h4>\r\n                    <p class=\"card-text\">{{event.venue }} {{ event.country }}</p>\r\n                    <div class=\"star-rating mt-1\" data-rating=\"5\">\r\n                      <div class=\"rating-counter\">5 reviews</div>\r\n                    </div>\r\n                  </div>\r\n                  <!-- end card-body -->\r\n                  <div class=\"card-footer bg-transparent border-top-gray\">\r\n                    <NuxtLink :to=\"`/edit-listing/${event.id}`\" class=\"btn btn-sm edit-btn bg-success text-white me-1\">\r\n                      Edit\r\n                    </NuxtLink>\r\n                    <a  @click=\"deleteEvent(event.id)\" class=\"btn btn-sm delete-btn bg-danger text-white\" >\r\n                      Delete\r\n                    </a>\r\n                  </div>\r\n                  <!-- end card-footer -->\r\n                </div>\r\n                <!-- end card -->\r\n              </div>\r\n            \r\n            </div>\r\n            <!-- end row -->\r\n          </div>\r\n          <!-- end tab-pane -->\r\n          <div\r\n            class=\"tab-pane fade\"\r\n            id=\"settings\"\r\n            role=\"tabpanel\"\r\n            aria-labelledby=\"settings-tab\"\r\n          >\r\n          <div class=\"row\">\r\n    <div class=\"col-lg-12\">\r\n      <h4 class=\"font-size-20 font-weight-semi-bold mb-3\">\r\n        Edit Profile\r\n      </h4>\r\n    </div>\r\n    <!-- end col-lg-12 -->\r\n    <div class=\"edit-profile-photo media mb-4 col-lg-12\">\r\n      <img :src=\"profile.profile_image_url || `${$config.public.baseURL}/`+profile.profile_image\" alt=\"avatar image\" class=\"profile-img me-4 flex-shrink-0\" />\r\n      <div class=\"file-upload-wrap file-upload-wrap-layout-2 media-body align-self-center\">\r\n        <input type=\"file\" @change=\"onFileChange\" class=\"multi file-upload-input with-preview\" multiple />\r\n        <span class=\"file-upload-text\"><i class=\"fal fa-upload me-2\"></i>Upload Photo</span>\r\n      </div>\r\n    </div>\r\n    <!-- end edit-profile-photo -->\r\n    <div class=\"col-lg-6 col-md-6\">\r\n      <label class=\"label-text\">Your Name</label>\r\n      <div class=\"form-group\">\r\n        <span class=\"fal fa-user form-icon\"></span>\r\n        <input class=\"form-control form--control\" type=\"text\" v-model=\"profile.name\" />\r\n      </div>\r\n      <!-- end form-group -->\r\n    </div>\r\n    <!-- end col-lg-6 -->\r\n    <div class=\"col-lg-6 col-md-6\">\r\n      <label class=\"label-text\">Your Email</label>\r\n      <div class=\"form-group\">\r\n        <span class=\"fal fa-envelope form-icon\"></span>\r\n        <input class=\"form-control form--control\" type=\"text\" v-model=\"profile.email\" />\r\n      </div>\r\n      <!-- end form-group -->\r\n    </div>\r\n    <div class=\"col-lg-6 col-md-6\">\r\n      <label class=\"label-text\">Phone Number</label>\r\n      <div class=\"form-group\">\r\n        <span class=\"fal fa-phone form-icon\"></span>\r\n        <input class=\"form-control form--control\" type=\"text\" v-model=\"profile.phone\" />\r\n      </div>\r\n      <!-- end form-group -->\r\n    </div>\r\n    <div class=\"col-lg-6 col-md-6\">\r\n      <label class=\"label-text\">Address</label>\r\n      <div class=\"form-group\">\r\n        <span class=\"fal fa-map-marker-alt form-icon\"></span>\r\n        <input class=\"form-control form--control\" type=\"text\" v-model=\"profile.address\" />\r\n      </div>\r\n      <!-- end form-group -->\r\n    </div>\r\n    <div class=\"col-lg-12\">\r\n      <label class=\"label-text\">Notes</label>\r\n      <div class=\"form-group\">\r\n        <textarea class=\"form-control form--control ps-3\" rows=\"6\" v-model=\"profile.description\"></textarea>\r\n      </div>\r\n      <!-- end form-group -->\r\n    </div>\r\n    <div class=\"col-lg-12 col-md-6\">\r\n      <label class=\"label-text\">Website</label>\r\n      <div class=\"form-group\">\r\n        <span class=\"fal fa-globe form-icon\"></span>\r\n        <input class=\"form-control form--control\" type=\"text\" v-model=\"profile.website\" />\r\n      </div>\r\n      <!-- end form-group -->\r\n    </div>\r\n    <!-- <div class=\"col-lg-6 col-md-6\">\r\n      <label class=\"label-text\">Facebook</label>\r\n      <div class=\"form-group\">\r\n        <span class=\"fab fa-facebook-f form-icon\"></span>\r\n        <input class=\"form-control form--control\" type=\"text\" v-model=\"profile.facebook\" />\r\n      </div>\r\n \r\n    </div>\r\n    <div class=\"col-lg-6 col-md-6\">\r\n      <label class=\"label-text\">Twitter</label>\r\n      <div class=\"form-group\">\r\n        <span class=\"fab fa-twitter form-icon\"></span>\r\n        <input class=\"form-control form--control\" type=\"text\" v-model=\"profile.twitter\" />\r\n      </div>\r\n     \r\n    </div>\r\n    <div class=\"col-lg-6 col-md-6\">\r\n      <label class=\"label-text\">Instagram</label>\r\n      <div class=\"form-group\">\r\n        <span class=\"fab fa-instagram form-icon\"></span>\r\n        <input class=\"form-control form--control\" type=\"text\" v-model=\"profile.instagram\" />\r\n      </div>\r\n    \r\n    </div> -->\r\n    <div class=\"col-lg-12\">\r\n      <button class=\"theme-btn mt-3 border-0\" type=\"button\" @click=\"saveChanges\">\r\n        Save Changes\r\n      </button>\r\n    </div>\r\n  </div>\r\n            <!-- end row -->\r\n            <hr class=\"border-top-gray my-5\" />\r\n            <div class=\"row d-none\">\r\n              <div class=\"col-lg-12\">\r\n                <h4 class=\"font-size-20 font-weight-semi-bold mb-3\">\r\n                  Change Password\r\n                </h4>\r\n              </div>\r\n              <!-- end col-lg-12 -->\r\n              <div class=\"col-lg-6 col-md-6\">\r\n                <label class=\"label-text\">Current Password</label>\r\n                <div class=\"form-group\">\r\n                  <span class=\"fal fa-lock form-icon\"></span>\r\n                  <input\r\n                    class=\"form-control form--control password-field\"\r\n                    type=\"password\"\r\n                    name=\"password\"\r\n                    placeholder=\"Current password\"\r\n                  />\r\n                </div>\r\n                <!-- end form-group -->\r\n              </div>\r\n              <!-- end col-lg-6 -->\r\n              <div class=\"col-lg-6 col-md-6\">\r\n                <label class=\"label-text\">New Password</label>\r\n                <div class=\"form-group\">\r\n                  <span class=\"fal fa-lock form-icon\"></span>\r\n                  <input\r\n                    class=\"form-control form--control password-field\"\r\n                    type=\"password\"\r\n                    name=\"password\"\r\n                    placeholder=\"New password\"\r\n                  />\r\n                </div>\r\n                <!-- end form-group -->\r\n              </div>\r\n              <!-- end col-lg-6 -->\r\n              <div class=\"col-lg-6 col-md-6\">\r\n                <label class=\"label-text\">New Password (again)</label>\r\n                <div class=\"form-group\">\r\n                  <span class=\"fal fa-lock form-icon\"></span>\r\n                  <input\r\n                    class=\"form-control form--control password-field\"\r\n                    type=\"password\"\r\n                    name=\"password\"\r\n                    placeholder=\"New password again\"\r\n                  />\r\n                </div>\r\n                <!-- end form-group -->\r\n              </div>\r\n              <!-- end col-lg-6 -->\r\n              <div class=\"col-lg-12\">\r\n                <a\r\n                  href=\"javascript:void(0)\"\r\n                  class=\"btn btn-light toggle-password\"\r\n                  data-bs-toggle=\"tooltip\"\r\n                  data-placement=\"right\"\r\n                  title=\"toggle show/hide password\"\r\n                >\r\n                  <i class=\"far fa-eye eye-on\"></i>\r\n                  <i class=\"far fa-eye-slash eye-off\"></i>\r\n                </a>\r\n              </div>\r\n              <!-- end col-lg-12 -->\r\n              <div class=\"col-lg-12\">\r\n                <button class=\"theme-btn mt-3 border-0\" type=\"button\">\r\n                  Change Password\r\n                </button>\r\n              </div>\r\n              <!-- end col-lg-12 -->\r\n            </div>\r\n            <!-- end row -->\r\n            <div class=\"border border-danger p-4 mt-5 rounded d-none\">\r\n              <h4 class=\"font-size-20 font-weight-semi-bold mb-1 text-danger\">\r\n                Delete Account\r\n              </h4>\r\n              <p class=\"mb-3\">\r\n                <span class=\"text-warning\">Warning:</span> Once you delete your\r\n                account, there is no going back. Please be certain.\r\n              </p>\r\n              <a\r\n                href=\"#\"\r\n                class=\"theme-btn bg-danger\"\r\n                data-bs-toggle=\"modal\"\r\n                data-bs-target=\"#deleteAccountModal\"\r\n                >Delete Account</a\r\n              >\r\n            </div>\r\n          </div>\r\n          <!-- end tab-pane -->\r\n        \r\n          <!-- end tab-pane -->\r\n        </div>\r\n        <!-- end tab-content -->\r\n      </div>\r\n    </section>\r\n\r\n\r\n</template>\r\n<script setup>\r\n  definePageMeta({\r\n  middleware: 'auth'\r\n})\r\nimport { ref,onMounted  } from 'vue';\r\nimport { useRouter } from 'vue-router';\r\nimport authService from '~/services/authService';\r\nimport eventService from '@/services/eventService'; // Adjust the path based on your project structure\r\nconst events = ref([]);\r\n\r\nconst router = useRouter();\r\n// Fetch events using eventService\r\n\r\nconst profile = ref({\r\n  name: '',\r\n  email: '',\r\n  phone: '',\r\n  address: '',\r\n  description: '',\r\n  profile_image: '',\r\n  profile_image_url: '',\r\n  website: '',\r\n  facebook: '',\r\n  twitter: '',\r\n  instagram: '',\r\n});\r\n\r\nconst onFileChange = (event) => {\r\n  const file = event.target.files[0];\r\n  if (file) {\r\n    profile.value.profile_image = file;\r\n    const reader = new FileReader();\r\n    reader.onload = (e) => {\r\n      profile.value.profile_image_url = e.target.result;\r\n    };\r\n    reader.readAsDataURL(file);\r\n  }\r\n};\r\n\r\nconst saveChanges = async () => {\r\n  try {\r\n    const updatedProfile = await authService.updateUserProfile(profile.value);\r\n    // console.log('Profile updated successfully:', updatedProfile);\r\n    useNuxtApp().$toast.success('Profile updated successfully!', {\r\n       autoClose: 5000,\r\n       theme: \"colored\",\r\n       dangerouslyHTMLString: true,\r\n     })\r\n  } catch (error) {\r\n    console.error('Error updating profile:', error);\r\n  }\r\n};\r\n\r\nconst getEvents = async () => {\r\n  try {\r\n    const data = await eventService.getUserListings();\r\n    events.value = data;\r\n   \r\n  } catch (error) {\r\n    console.error('Error fetching events:', error);\r\n    // Handle error as needed\r\n  }\r\n};\r\nconst getProfile = async () => {\r\n  try {\r\n    const data = await authService.getUserProfile();\r\n    profile.value = data;\r\n  } catch (error) {\r\n    console.error('Error fetching profile:', error);\r\n    // Handle error as needed\r\n  }\r\n};\r\n// Fetch events when component is mounted\r\nonMounted(() => {\r\n  getEvents();\r\n  getProfile();\r\n});\r\nconst logoutUser = async () => {\r\n  try {\r\n    // Optionally, you can call a logout endpoint in your Laravel API to invalidate the token\r\n    await authService.logout();\r\n\r\n    // Clear the token from local storage\r\n    localStorage.removeItem('access_token');\r\n\r\n    // Redirect to the login page\r\n    router.push('/login');\r\n    \r\n    // Show a success message\r\n    useNuxtApp().$toast.success('Successfully logged out.', {\r\n      autoClose: 5000,\r\n      theme: \"colored\",\r\n      dangerouslyHTMLString: true,\r\n    });\r\n  } catch (error) {\r\n    console.error('Error logging out:', error);\r\n    useNuxtApp().$toast.error('Failed to logout. Please try again.', {\r\n      autoClose: 5000,\r\n      theme: \"colored\",\r\n      dangerouslyHTMLString: true,\r\n    });\r\n  }\r\n};\r\nconst deleteEvent = async (id) => {\r\n    try {\r\n        const result = await useNuxtApp().$swal.fire({\r\n            title: 'Are you sure?',\r\n            text: \"You won't be able to revert this!\",\r\n            icon: 'warning',\r\n            showCancelButton: true,\r\n            confirmButtonColor: '#3085d6',\r\n            cancelButtonColor: '#d33',\r\n            confirmButtonText: 'Yes, delete it!'\r\n        });\r\n\r\n        if (result.isConfirmed) {\r\n            // User confirmed deletion, proceed with deleting event\r\n         await eventService.deleteEvent(id);\r\n       useNuxtApp().$toast.success('Your event has been deleted.', {\r\n      autoClose: 5000,\r\n      theme: \"colored\",\r\n      dangerouslyHTMLString: true,\r\n    });\r\n    getEvents();\r\n        }\r\n    } catch (error) {\r\n        useNuxtApp().$swal.fire(\r\n            'Error!',\r\n            'Failed to delete event.',\r\n            'error'\r\n        );\r\n        console.error('Error deleting event:', error);\r\n    }\r\n};\r\n\r\n</script>"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AAkWA,UAAM,SAAS,IAAI,CAAA,CAAE;AAEN,cAAY;AAG3B,UAAM,UAAU,IAAI;AAAA,MAClB,MAAM;AAAA,MACN,OAAO;AAAA,MACP,OAAO;AAAA,MACP,SAAS;AAAA,MACT,aAAa;AAAA,MACb,eAAe;AAAA,MACf,mBAAmB;AAAA,MACnB,SAAS;AAAA,MACT,UAAU;AAAA,MACV,SAAS;AAAA,MACT,WAAW;AAAA,IACb,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}